# VideoDetected
个人视频信息监控管理系统
## 使用方法
下载release中的apk文件安装即可，支持安卓10
第一次打开需要设置uid（即被观察的b站up主账号id）


## 简单的介绍视频
https://www.bilibili.com/video/BV1A84y1h7To

## 详谈
1.1 软件需求及功能分析
直观性：以直观的方式展示主要图文信息，次要的搜索排序等功能需要隐藏在侧边栏避免扰乱用户注意力。
及时性：软件设计为打开时从互联网获取相关信息，并可通过设置调整定时获取最新消息，主页面同时设置了刷新按钮以满足用户主动获取信息的需求。
可编辑性：获取的视频信息以“栏”的形式在主页显示，点击即可查看详细信息，在此处同时可以进行编辑/保存操作。
美观性：使用官方控件及部分第三方控件，避免过于简陋的设计风格，使用户起码没有抵触心里。
复用性：多次页面可能使用同一数据，为提高软件效率应使用控件复用以避免无谓的时空损耗。

功能分析：单纯的图书管理系统似乎并不适用大多数人群，原版功能甚至无法点开阅读，仅仅作为纸质书籍收藏品的管理软件在当前时代似乎是不够用的（毕竟电子书籍与音视频流媒体才是主流），因此本软件对参考软件做了功能上的删改，目的是实时监控视频平台的数据信息（可以是自己的视频也可以其他up主，设置uid即可），并提供了搜索排序增删改等数据处理接口。软件功能流程可以简化为：从互联网获取json数据->将json数据处理为内部类->按照一定的格式直观展示信息->响应处理逻辑，工作量主要在前端优化与后台逻辑处理
1.2 Activity设计
本项目共有三个Activity，一个函数类，一个Adapter，一个内部类
MainActivity：处理主页显示逻辑以及沟通其他Activity，如设置状态栏与toolbar样式，设置主页元素点击事件，渲染主页layout（包括侧边栏），其中主页元素使用recyclerview渲染，因此需要一个Adapter进行相关设置，而在Adapter中绑定了主页元素的点击事件，当该事件触发时跳转至DetailedActivity显示视频详细信息。
DetailedActivity：展示视频详细信息，并提供删改接口，删改后的内容加载入内存并通过handle机制通知主页面进行页面元素的改变。
SettingActivity：本Activity设计的比较简单，使用了Preference构建了设置界面，值得注意的是为保证某些控件仅接受整型输入，需要在Fragment的函数中重写该控件的相关属性。
函数类：大部分逻辑处理的函数都封装在该类，如从互联网获取json数据的函数、从超链接获取bitmap图像数据的函数、搜索排序函数以及本地图片的保存与读取等函数。设计目的是为了元素复用，如获取同一张图片时不需要重复到互联网下载，仅需从缓存中拿取即可。
内部类：准确的说是Video类，其中定义了几种构造方法以适用不同需求，如直接传值构造与json串构造、layout元素构造，通过这种设计，其他activity可以直接获取本类的属性，更加简洁方便。



1.3 关键实现技术
似乎没有什么特别重要的实现技术（因为很多方式都是相辅相成缺一不可的，如okhttp获取json，drawerlayout渲染侧边栏）
不过令人较为困扰的可以说是安卓的信息传递机制，本项目中使用过handler与registerForActivityResult等信息传递方式，其目的基本上是为了响应异步消息处理结果（似乎是为了提高主UI效率），起到监听器的作用，回传时可以通过bundle传递额外信息（如类、bitmap），相比intent可以传递更大的数据量，本项目在下载互联网图片与两个Activity间传递图片信息时曾使用过（不过后来还是因为优化问题改作从本地路径获取图片了）
其中registerForActivityResult所使用的信息传递机制，即setResult，其解决晚于return，且不可再static类中调用，因此在实际使用中造成了很大困扰，如编辑保存音频信息时需要先行通过intent传递相关信息再return，直接将信息放在return中该监听器是获取不到的。另外在settingActivity中为实现设置变更即更新主页元素的功能，也不得不使用该监听器，但其无法在static函数中调用的设计使得最终不得不使用捕获activity退出事件（onBackPressed()）来进行相关数据传输这样极其不优雅的解决方式。总之，安卓的信息传递机制十分令人困扰。
1.4 测试及APP使用说明
未写自动测试，因此在此处展示软件截图与相关使用说明了
![image](https://github.com/user-attachments/assets/8e88396d-1540-4aed-af1b-77d680070cef)

 
软件主页面分为toolbar与content两部分，toolbar显示一个侧边栏按钮与用户名，content以栏的形式展示视频音像信息。
![image](https://github.com/user-attachments/assets/b5d77f58-556a-48d3-8b10-bb34aacf2e4d)

![image](https://github.com/user-attachments/assets/db54191d-b66b-4545-ba64-e612e12f8776)

![image](https://github.com/user-attachments/assets/fd024ca8-2185-492f-b9a4-9b7325770fe0)

    
点击左上角按钮可以打开侧边栏，侧边栏上半部分是一个自定义framelayout，显示壁纸与当前时间日期，该日期在启动软件时自动获取并更新。
侧边栏下方从上至下五个item，分别是跳转回首页，搜索（可实现动态加载，即背景元素实时匹配搜索词），对视频进行排序（排序条件目前有播放量、弹幕量、发布时间、时长），跳转设置页面与跳转关于页面
![image](https://github.com/user-attachments/assets/a24b0570-1205-426d-92b7-ed8c62eed809)
![image](https://github.com/user-attachments/assets/63ee92af-a392-42e4-8633-fbe9fe8ac360)

  
在主页面点击该视频会弹出详情页（使用slidingactivity构建），在该详情页可通过右上角编辑按钮进行页面元素的编辑，部分元素限制了整型输入，因此避免了类型不匹配的错误
另外，考虑到单独设置删除按钮不甚美观，因此设置为主页长按该元素会删除，并配有删除动画，不方便截图因此不做展示。
![image](https://github.com/user-attachments/assets/8e9e4707-f5ee-4cae-9c9b-46254cc45c0f)

 
设置页面中设置了昵称与uid，uid即为主页展示视频的所有者，可以通过在此修改uid来实现监控不同用户视频更新情况的需求，另外高级设置中标注了主页容量与元素起始，该设置实际上是规定了json获取时的请求格式，可以实现主页视频的定制化
另外设置中的定时刷新选项是为了避免用户手动点击刷新的麻烦，规定间隔多长时间重新获取一次数据并更新页面，用处不多因此不作强调。
